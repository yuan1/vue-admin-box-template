import{z as Z,A as ee,B as te,C as R,D as ae,a as z,r as x,G as J,o as T,f as S,l as V,e as p,u as i,q as P,p as K,F as L,g as B,H as le,t as W,v as F,E as H,I as ne,J as oe,c as N,w,h as I,_ as se,x as A,i as re,j as ie,k,K as ce,m as ue,n as de,s as fe,y as pe,L as _e}from"./index-3e097ba8.js";import{i as me,j as ve,a as ge,u as be,E as ye,b as he,c as we,d as Ee,T as Te,g as xe,e as De,f as Ce,h as Se,v as Ve}from"./el-radio-75d09949.js";const q=e=>{let l=0,t=e;for(;t;)l+=t.offsetTop,t=t.offsetParent;return l},$e=(e,l)=>Math.abs(q(e)-q(l));var Ie="Expected a function";function G(e,l,t){var a=!0,n=!0;if(typeof e!="function")throw new TypeError(Ie);return Z(t)&&(a="leading"in t?!!t.leading:a,n="trailing"in t?!!t.trailing:n),me(e,l,{leading:a,maxWait:l,trailing:n})}const D="ElInfiniteScroll",Ne=50,ke=200,Oe=0,Le={delay:{type:Number,default:ke},distance:{type:Number,default:Oe},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},j=(e,l)=>Object.entries(Le).reduce((t,[a,n])=>{var s,f;const{type:g,default:b}=n,c=e.getAttribute(`infinite-scroll-${a}`);let _=(f=(s=l[c])!=null?s:c)!=null?f:b;return _=_==="false"?!1:_,_=g(_),t[a]=Number.isNaN(_)?b:_,t},{}),X=e=>{const{observer:l}=e[D];l&&(l.disconnect(),delete e[D].observer)},Be=(e,l)=>{const{container:t,containerEl:a,instance:n,observer:s,lastScrollTop:f}=e[D],{disabled:g,distance:b}=j(e,n),{clientHeight:c,scrollHeight:_,scrollTop:y}=a,u=y-f;if(e[D].lastScrollTop=y,s||g||u<0)return;let d=!1;if(t===e)d=_-(c+y)<=b;else{const{clientTop:r,scrollHeight:v}=e,m=$e(e,a);d=y+c>=m+r+v-b}d&&l.call(n)};function O(e,l){const{containerEl:t,instance:a}=e[D],{disabled:n}=j(e,a);n||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?l.call(a):X(e))}const Fe={async mounted(e,l){const{instance:t,value:a}=l;ee(a)||te(D,"'v-infinite-scroll' binding value must be a function"),await R();const{delay:n,immediate:s}=j(e,t),f=ae(e,!0),g=f===window?document.documentElement:f,b=G(Be.bind(null,e,a),n);if(f){if(e[D]={instance:t,container:f,containerEl:g,delay:n,cb:a,onScroll:b,lastScrollTop:g.scrollTop},s){const c=new MutationObserver(G(O.bind(null,e,a),Ne));e[D].observer=c,c.observe(e,{childList:!0,subtree:!0}),O(e,a)}f.addEventListener("scroll",b)}},unmounted(e){const{container:l,onScroll:t}=e[D];l==null||l.removeEventListener("scroll",t),X(e)},async updated(e){if(!e[D])await R();else{const{containerEl:l,cb:t,observer:a}=e[D];l.clientHeight&&a&&O(e,t)}}},U=Fe;U.install=e=>{e.directive("InfiniteScroll",U)};const Ae=U;function Ue(e,l,t){var a=t||{},n=a.noTrailing,s=n===void 0?!1:n,f=a.noLeading,g=f===void 0?!1:f,b=a.debounceMode,c=b===void 0?void 0:b,_,y=!1,u=0;function d(){_&&clearTimeout(_)}function r(m){var E=m||{},h=E.upcomingOnly,C=h===void 0?!1:h;d(),y=!C}function v(){for(var m=arguments.length,E=new Array(m),h=0;h<m;h++)E[h]=arguments[h];var C=this,o=Date.now()-u;if(y)return;function $(){u=Date.now(),l.apply(C,E)}function M(){_=void 0}!g&&c&&!_&&$(),d(),c===void 0&&o>e?g?(u=Date.now(),s||(_=setTimeout(c?M:$,e))):$():s!==!0&&(_=setTimeout(c?M:$,c===void 0?e-o:e))}return v.cancel=r,v}function ze(e,l,t){var a=t||{},n=a.atBegin,s=n===void 0?!1:n;return Ue(e,l,{debounceMode:s!==!1})}const He=e=>(ne("data-v-af38eb6e"),e=e(),oe(),e),je={class:"category"},Me={class:"header-box"},Re=He(()=>V("h2",null,"分类列表",-1)),qe=["onClick"],Ge={key:0,class:"load-tip"},Je={key:1,class:"load-tip"},Pe={__name:"category",setup(e){const l=x(null),t={index:1,size:30,total:0};let a=x(""),n=x([]),s=x(!0),f=x(!0),g=J("active"),b=x(!1);const c=u=>{if(f.value=!0,u||s.value)s.value=!1,t.index=1,l.value&&(l.value.scrollTop=0);else if(t.index*t.size>=t.total){f.value=!1,b.value=!0;return}let d={page:t.index,pageSize:t.size,keyword:a.value};ve(d).then(r=>{t.index===1?(n.value=r.data.list,g.value=n.value[0]):n.value=n.value.concat(r.data.list),t.index+=1,t.total=r.data.pager.total}).catch(r=>{t.index=1,t.total=0,n.value=[]}).finally(()=>{f.value=!1})},_=ze(300,c),y=u=>{g.value=u};return c(!0),(u,d)=>{const r=H,v=Ae;return T(),S("div",je,[V("div",Me,[Re,p(r,{modelValue:i(a),"onUpdate:modelValue":d[0]||(d[0]=m=>P(a)?a.value=m:a=m),placeholder:"请输入内容",onInput:d[1]||(d[1]=m=>i(_)(!0))},null,8,["modelValue"])]),K((T(),S("ul",{class:"list system-scrollbar",ref_key:"listDom",ref:l,"infinite-scroll-immediate":!1,style:{overflow:"auto"}},[(T(!0),S(L,null,B(i(n),m=>(T(),S("li",{key:m.id,class:le({active:m.id===i(g).id}),onClick:E=>y(m)},[V("span",null,W(m.name),1)],10,qe))),128)),i(f)?(T(),S("p",Ge,"加载中...")):F("",!0),i(b)?(T(),S("p",Je,"数据加载完成")):F("",!0)])),[[v,c]])])}}},Ke=z(Pe,[["__scopeId","data-v-af38eb6e"]]),Y=[{value:1,label:"运动"},{value:2,label:"健身"},{value:3,label:"跑酷"},{value:4,label:"街舞"}],Q=[{value:1,label:"今天"},{value:2,label:"明天"},{value:3,label:"后天"}],We={__name:"layer",props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},emits:["getTableData"],setup(e,{emit:l}){const t=e,a=x(null),n=x(null);let s=x({name:""});const f={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],number:[{required:!0,message:"请输入数字",trigger:"blur"}],choose:[{required:!0,message:"请选择",trigger:"blur"}],radio:[{required:!0,message:"请选择",trigger:"blur"}]};g();function g(){t.layer.row&&(s.value=JSON.parse(JSON.stringify(t.layer.row)))}function b(){a.value&&a.value.validate(y=>{if(y){let u=s.value;t.layer.row?_(u):c(u)}else return!1})}function c(y){ge(y).then(u=>{A({type:"success",message:"新增成功"}),l("getTableData",!0),n.value&&n.value.close()})}function _(y){be(y).then(u=>{A({type:"success",message:"编辑成功"}),l("getTableData",!1),n.value&&n.value.close()})}return(y,u)=>{const d=H,r=re,v=ye,m=he,E=we,h=Ee,C=ie;return T(),N(se,{layer:e.layer,onConfirm:b,ref_key:"layerDom",ref:n},{default:w(()=>[p(C,{model:i(s),rules:f,ref_key:"ruleForm",ref:a,"label-width":"120px",style:{"margin-right":"30px"}},{default:w(()=>[p(r,{label:"名称：",props:"name"},{default:w(()=>[p(d,{modelValue:i(s).name,"onUpdate:modelValue":u[0]||(u[0]=o=>i(s).name=o),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),p(r,{label:"数字：",props:"number"},{default:w(()=>[p(d,{modelValue:i(s).number,"onUpdate:modelValue":u[1]||(u[1]=o=>i(s).number=o),oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"只能输入正整数"},null,8,["modelValue"])]),_:1}),p(r,{label:"选择器：",props:"select"},{default:w(()=>[p(m,{modelValue:i(s).choose,"onUpdate:modelValue":u[2]||(u[2]=o=>i(s).choose=o),placeholder:"请选择",clearable:""},{default:w(()=>[(T(!0),S(L,null,B(i(Y),o=>(T(),N(v,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),p(r,{label:"单选框：",props:"radio"},{default:w(()=>[p(h,{modelValue:i(s).radio,"onUpdate:modelValue":u[3]||(u[3]=o=>i(s).radio=o)},{default:w(()=>[(T(!0),S(L,null,B(i(Q),o=>(T(),N(E,{key:o.value,label:o.value},{default:w(()=>[I(W(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["layer"])}}};const Xe={class:"layout-container"},Ye={class:"layout-container-form flex space-between"},Qe={class:"layout-container-form-handle"},Ze={class:"layout-container-form-search"},et={class:"layout-container-table"},tt={__name:"my-table",setup(e){const l=k({input:""}),t=k({show:!1,title:"新增",showButton:!0}),a=k({index:1,size:20,total:0}),n=J("active"),s=x(!0),f=x([]),g=x([]),b=d=>{g.value=d},c=d=>{s.value=!0,d&&(a.index=1);let r={category:n.value.id,page:a.index,pageSize:a.size,...l};xe(r).then(v=>{let m=v.data.list;Array.isArray(m)&&m.forEach(E=>{const h=Y.find(o=>o.value===E.choose);h?E.chooseName=h.label:E.chooseName=E.choose;const C=Q.find(o=>o.value===E.radio);C?E.radioName=C.label:E.radio}),f.value=v.data.list,a.total=Number(v.data.pager.total)}).catch(v=>{f.value=[],a.index=1,a.total=0}).finally(()=>{s.value=!1})},_=d=>{let r={ids:d.map(v=>v.id).join(",")};De(r).then(v=>{A({type:"success",message:"删除成功"}),c(f.value.length===1)})},y=()=>{t.title="新增数据",t.show=!0,delete t.row},u=d=>{t.title="编辑数据",t.row=d,t.show=!0};return ce(n,d=>{c(!0)}),(d,r)=>{const v=pe,m=Ce,E=H,h=Se,C=Ve;return T(),S("div",Xe,[V("div",Ye,[V("div",Qe,[p(v,{type:"primary",icon:i(ue),onClick:y},{default:w(()=>[I("新增")]),_:1},8,["icon"]),p(m,{title:"批量删除",onConfirm:r[0]||(r[0]=o=>_(i(g)))},{reference:w(()=>[p(v,{type:"danger",icon:i(de),disabled:i(g).length===0},{default:w(()=>[I("批量删除")]),_:1},8,["icon","disabled"])]),_:1})]),V("div",Ze,[p(E,{modelValue:i(l).input,"onUpdate:modelValue":r[1]||(r[1]=o=>i(l).input=o),placeholder:"请输入关键词进行检索",onChange:r[2]||(r[2]=o=>c(!0))},null,8,["modelValue"]),p(v,{type:"primary",icon:i(fe),class:"search-btn",onClick:r[3]||(r[3]=o=>c(!0))},{default:w(()=>[I("搜索")]),_:1},8,["icon"])])]),V("div",et,[K((T(),N(Te,{ref:"table",page:i(a),"onUpdate:page":r[4]||(r[4]=o=>P(a)?a.value=o:null),showIndex:!0,showSelection:!0,data:i(f),onGetTableData:c,onSelectionChange:b},{default:w(()=>[p(h,{prop:"name",label:"名称",align:"center"}),p(h,{prop:"number",label:"数字",align:"center"}),p(h,{prop:"chooseName",label:"选择器",align:"center"}),p(h,{prop:"radioName",label:"单选框",align:"center"}),p(h,{label:"操作",align:"center",fixed:"right",width:"200"},{default:w(o=>[p(v,{onClick:$=>u(o.row)},{default:w(()=>[I("编辑")]),_:2},1032,["onClick"]),p(m,{title:"删除",onConfirm:$=>_([o.row])},{reference:w(()=>[p(v,{type:"danger"},{default:w(()=>[I("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["page","data"])),[[C,i(s)]]),i(t).show?(T(),N(We,{key:0,layer:i(t),onGetTableData:c},null,8,["layer"])):F("",!0)])])}}},at=z(tt,[["__scopeId","data-v-97978335"]]);const lt={class:"full"},nt={class:"left"},ot={class:"content"},st={__name:"index",setup(e){let l=x({});return _e("active",l),(t,a)=>(T(),S("div",lt,[V("div",nt,[p(Ke)]),V("div",ot,[p(at)])]))}},ct=z(st,[["__scopeId","data-v-0fb61ed8"]]);export{ct as default};
